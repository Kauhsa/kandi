digraph {
    rankdir = LR;
    
    dok1[label = <(dokumentti 1,<br/>"kissa koira <br/> vene hauki")>; shape = "box"];
    dok2[label = <(dokumentti 2,<br/>"koira vene <br/> kissa pihvi")>; shape = "box"];

    kissa1[label = "(kissa, 1)"; shape = "box"];
    kissa2[label = "(kissa, 1)"; shape = "box"];
    koira1[label = "(koira, 1)"; shape = "box"];
    koira2[label = "(koira, 1)"; shape = "box"];
    
    map1[label = "map";];
    map2[label = "map";];

    red_kissa[label = "reduce";];
    red_koira[label = "reduce";];

    res_kissa[label = "(kissa, 2)"; shape = "box"];
    res_koira[label = "(koira, 2)"; shape = "box"];

    dok1 -> map1;
    dok2 -> map2;
    map1 -> kissa1;
    map1 -> koira1;
    map2 -> kissa2;
    map2 -> koira2;
    kissa1 -> red_kissa;
    kissa2 -> red_kissa;
    koira1 -> red_koira;
    koira2 -> red_koira;
    red_kissa -> res_kissa;
    red_koira -> res_koira;
}